<!DOCTYPE html>
<html>
<head>
  <title>Home</title>
  <link rel="stylesheet" href="/styles.css">
  <style>
    .muted{color:#94a3b8;font-size:13px}
    .hero{display:flex;flex-direction:column;gap:12px;align-items:flex-start}
    .cta{display:flex;gap:8px}
    .tiles{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:12px}
    @media(max-width:900px){.tiles{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:600px){.tiles{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <%- include('partials/header') %>

  <div class="container">
    <% if (!user) { %>
      <!-- Visitor view -->
      <div class="card">
        <div class="hero">
          <h1>Welcome</h1>
          <p class="muted">Please sign up or log in to continue.</p>
          <div class="cta">
            <a class="btn" href="/signup">Sign up</a>
            <a class="btn btn-outline" href="/login">Login</a>
          </div>
        </div>
      </div>
    <% } else { %>
      <!-- Signed-in view: نفس الشكل لكل الأدوار -->
      <h1>Welcome <%= user.name || user.email %></h1>
      <p class="muted">High-level overview. Use your Dashboard to manage anything.</p>

      <div class="tiles">
        <div class="tile">
          <div class="kpi"><%= (insights && insights.totalProjects) || 0 %></div>
          <div class="muted">Total Projects</div>
        </div>
        <div class="tile">
          <div class="kpi"><%= (insights && insights.totalUsers) || 0 %></div>
          <div class="muted">Approved Users</div>
        </div>
        <div class="tile">
          <div class="kpi"><%= (insights && insights.myProjects) || 0 %></div>
          <div class="muted">My Projects</div>
        </div>
        <div class="tile">
          <div class="kpi"><%= (insights && insights.myAssigns) || 0 %></div>
          <div class="muted">My Assignments</div>
        </div>
      </div>

      <div class="card" style="margin-top:16px;display:flex;align-items:center;justify-content:space-between;gap:12px">
        <div>
          <h3 style="margin:0 0 6px 0">Go to your workspace</h3>
          <p class="muted" style="margin:0">All actions live inside your role dashboard.</p>
        </div>
        <a class="btn" href="/dashboard">Go to Dashboard</a>
      </div>
    <% } %>
  </div>
</body>
</html>
