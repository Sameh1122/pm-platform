<!DOCTYPE html>
<html>
<head><title>Manager × Target</title><link rel="stylesheet" href="/styles.css">
<style>table{border-collapse:collapse;width:100%}th,td{border:1px solid #ddd;padding:6px 8px;text-align:center}</style>
</head>
<body>
  <%- include('partials/header') %>
  <div class="container">
    <h1>Manager × Target</h1>
    <p><a class="btn" href="/admin/features">Role × Feature</a></p>
    <% if (!managerRoles || managerRoles.length===0) { %>
      <p>No manager roles have assign_members.</p>
    <% } else { %>
      <table>
        <thead><tr><th>Manager \\ Target</th>
          <% targetRoles.forEach(function(t){ %><th><%= t.name %></th><% }) %>
        </tr></thead>
        <tbody>
          <% managerRoles.forEach(function(m){ %>
            <tr>
              <td><strong><%= m.name %></strong></td>
              <% targetRoles.forEach(function(t){
                var allowed = (matrix.get(m.id) || new Set()).has(t.id);
              %>
                <td>
                  <form method="POST" action="/admin/assignable/toggle">
                    <input type="hidden" name="managerRoleId" value="<%= m.id %>">
                    <input type="hidden" name="targetRoleId" value="<%= t.id %>">
                    <input type="hidden" name="enabled" value="<%= allowed ? 0 : 1 %>">
                    <button class="btn btn-xs <%= allowed?'':'btn-outline' %>" type="submit"><%= allowed?'On':'Off' %></button>
                  </form>
                </td>
              <% }) %>
            </tr>
          <% }) %>
        </tbody>
      </table>
    <% } %>
  </div>
</body>
</html>
